{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"]}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"]}},{"name":"expo/fetch","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":58,"index":158},"end":{"line":3,"column":79,"index":179}}],"key":"N1BhEB2VCRYUaBv6+fzUf2KASpM=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _env2 = require(_dependencyMap[0], \"expo/virtual/env\");\n  var SecureStore = _interopRequireWildcard(require(_dependencyMap[1], \"expo-secure-store\"));\n  function _interopRequireWildcard(e, t) { if (\"function\" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) \"default\" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }\n  // Use native fetch on web, expo/fetch for native\n  const expoFetch = typeof window !== 'undefined' ? fetch : require(_dependencyMap[2], \"expo/fetch\").fetch;\n  const originalFetch = typeof window !== 'undefined' ? window.fetch : global.fetch;\n  const authKey = `${_env2.env.EXPO_PUBLIC_PROJECT_GROUP_ID}-jwt`;\n  const getURLFromArgs = (...args) => {\n    const [urlArg] = args;\n    let url;\n    if (typeof urlArg === 'string') {\n      url = urlArg;\n    } else if (typeof urlArg === 'object' && urlArg !== null) {\n      url = urlArg.url;\n    } else {\n      url = null;\n    }\n    return url;\n  };\n  const isFirstPartyURL = url => {\n    return url.startsWith('/') || _env2.env.EXPO_PUBLIC_BASE_URL && url.startsWith(_env2.env.EXPO_PUBLIC_BASE_URL);\n  };\n  const isSecondPartyURL = url => {\n    return url.startsWith('/_create/');\n  };\n  const fetchToWeb = async function fetchWithHeaders(...args) {\n    const firstPartyURL = _env2.env.EXPO_PUBLIC_BASE_URL;\n    const secondPartyURL = _env2.env.EXPO_PUBLIC_PROXY_BASE_URL;\n    if (!firstPartyURL || !secondPartyURL) {\n      return expoFetch(...args);\n    }\n    const [input, init] = args;\n    const url = getURLFromArgs(input, init);\n    if (!url) {\n      return expoFetch(input, init);\n    }\n    const isExternalFetch = !isFirstPartyURL(url);\n    // we should not add headers to requests that don't go to our own server\n    if (isExternalFetch) {\n      return expoFetch(input, init);\n    }\n    let finalInput = input;\n    const baseURL = isSecondPartyURL(url) ? secondPartyURL : firstPartyURL;\n    if (typeof input === 'string') {\n      finalInput = input.startsWith('/') ? `${baseURL}${input}` : input;\n    } else {\n      return originalFetch(input, init);\n    }\n    const initHeaders = init?.headers ?? {};\n    const finalHeaders = new Headers(initHeaders);\n    const headers = {\n      'x-createxyz-project-group-id': _env2.env.EXPO_PUBLIC_PROJECT_GROUP_ID,\n      host: _env2.env.EXPO_PUBLIC_HOST,\n      'x-forwarded-host': _env2.env.EXPO_PUBLIC_HOST,\n      'x-createxyz-host': _env2.env.EXPO_PUBLIC_HOST\n    };\n    for (const [key, value] of Object.entries(headers)) {\n      if (value) {\n        finalHeaders.set(key, value);\n      }\n    }\n    const auth = await SecureStore.getItemAsync(authKey).then(auth => {\n      return auth ? JSON.parse(auth) : null;\n    }).catch(() => {\n      return null;\n    });\n    if (auth) {\n      finalHeaders.set('authorization', `Bearer ${auth.jwt}`);\n    }\n    return expoFetch(finalInput, {\n      ...init,\n      headers: finalHeaders\n    });\n  };\n  var _default = exports.default = fetchToWeb;\n});","lineCount":81,"map":[[7,2,1,0],[7,6,1,0,"SecureStore"],[7,17,1,0],[7,20,1,0,"_interopRequireWildcard"],[7,43,1,0],[7,44,1,0,"require"],[7,51,1,0],[7,52,1,0,"_dependencyMap"],[7,66,1,0],[8,2,1,49],[8,11,1,49,"_interopRequireWildcard"],[8,35,1,49,"e"],[8,36,1,49],[8,38,1,49,"t"],[8,39,1,49],[8,68,1,49,"WeakMap"],[8,75,1,49],[8,81,1,49,"r"],[8,82,1,49],[8,89,1,49,"WeakMap"],[8,96,1,49],[8,100,1,49,"n"],[8,101,1,49],[8,108,1,49,"WeakMap"],[8,115,1,49],[8,127,1,49,"_interopRequireWildcard"],[8,150,1,49],[8,162,1,49,"_interopRequireWildcard"],[8,163,1,49,"e"],[8,164,1,49],[8,166,1,49,"t"],[8,167,1,49],[8,176,1,49,"t"],[8,177,1,49],[8,181,1,49,"e"],[8,182,1,49],[8,186,1,49,"e"],[8,187,1,49],[8,188,1,49,"__esModule"],[8,198,1,49],[8,207,1,49,"e"],[8,208,1,49],[8,214,1,49,"o"],[8,215,1,49],[8,217,1,49,"i"],[8,218,1,49],[8,220,1,49,"f"],[8,221,1,49],[8,226,1,49,"__proto__"],[8,235,1,49],[8,243,1,49,"default"],[8,250,1,49],[8,252,1,49,"e"],[8,253,1,49],[8,270,1,49,"e"],[8,271,1,49],[8,294,1,49,"e"],[8,295,1,49],[8,320,1,49,"e"],[8,321,1,49],[8,330,1,49,"f"],[8,331,1,49],[8,337,1,49,"o"],[8,338,1,49],[8,341,1,49,"t"],[8,342,1,49],[8,345,1,49,"n"],[8,346,1,49],[8,349,1,49,"r"],[8,350,1,49],[8,358,1,49,"o"],[8,359,1,49],[8,360,1,49,"has"],[8,363,1,49],[8,364,1,49,"e"],[8,365,1,49],[8,375,1,49,"o"],[8,376,1,49],[8,377,1,49,"get"],[8,380,1,49],[8,381,1,49,"e"],[8,382,1,49],[8,385,1,49,"o"],[8,386,1,49],[8,387,1,49,"set"],[8,390,1,49],[8,391,1,49,"e"],[8,392,1,49],[8,394,1,49,"f"],[8,395,1,49],[8,411,1,49,"t"],[8,412,1,49],[8,416,1,49,"e"],[8,417,1,49],[8,433,1,49,"t"],[8,434,1,49],[8,441,1,49,"hasOwnProperty"],[8,455,1,49],[8,456,1,49,"call"],[8,460,1,49],[8,461,1,49,"e"],[8,462,1,49],[8,464,1,49,"t"],[8,465,1,49],[8,472,1,49,"i"],[8,473,1,49],[8,477,1,49,"o"],[8,478,1,49],[8,481,1,49,"Object"],[8,487,1,49],[8,488,1,49,"defineProperty"],[8,502,1,49],[8,507,1,49,"Object"],[8,513,1,49],[8,514,1,49,"getOwnPropertyDescriptor"],[8,538,1,49],[8,539,1,49,"e"],[8,540,1,49],[8,542,1,49,"t"],[8,543,1,49],[8,550,1,49,"i"],[8,551,1,49],[8,552,1,49,"get"],[8,555,1,49],[8,559,1,49,"i"],[8,560,1,49],[8,561,1,49,"set"],[8,564,1,49],[8,568,1,49,"o"],[8,569,1,49],[8,570,1,49,"f"],[8,571,1,49],[8,573,1,49,"t"],[8,574,1,49],[8,576,1,49,"i"],[8,577,1,49],[8,581,1,49,"f"],[8,582,1,49],[8,583,1,49,"t"],[8,584,1,49],[8,588,1,49,"e"],[8,589,1,49],[8,590,1,49,"t"],[8,591,1,49],[8,602,1,49,"f"],[8,603,1,49],[8,608,1,49,"e"],[8,609,1,49],[8,611,1,49,"t"],[8,612,1,49],[9,2,2,0],[10,2,3,0],[10,8,3,6,"expoFetch"],[10,17,3,15],[10,20,3,18],[10,27,3,25,"window"],[10,33,3,31],[10,38,3,36],[10,49,3,47],[10,52,3,50,"fetch"],[10,57,3,55],[10,60,3,58,"require"],[10,67,3,65],[10,68,3,65,"_dependencyMap"],[10,82,3,65],[10,99,3,78],[10,100,3,79],[10,101,3,80,"fetch"],[10,106,3,85],[11,2,5,0],[11,8,5,6,"originalFetch"],[11,21,5,19],[11,24,5,22],[11,31,5,29,"window"],[11,37,5,35],[11,42,5,40],[11,53,5,51],[11,56,5,54,"window"],[11,62,5,60],[11,63,5,61,"fetch"],[11,68,5,66],[11,71,5,69,"global"],[11,77,5,75],[11,78,5,76,"fetch"],[11,83,5,81],[12,2,6,0],[12,8,6,6,"authKey"],[12,15,6,13],[12,18,6,16],[12,21,6,16,"_env2"],[12,26,6,16],[12,27,6,16,"env"],[12,30,6,16],[12,31,6,16,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[12,59,6,16],[12,65,6,65],[13,2,8,0],[13,8,8,6,"getURLFromArgs"],[13,22,8,20],[13,25,8,23,"getURLFromArgs"],[13,26,8,24],[13,29,8,27,"args"],[13,33,8,57],[13,38,8,62],[14,4,9,2],[14,10,9,8],[14,11,9,9,"urlArg"],[14,17,9,15],[14,18,9,16],[14,21,9,19,"args"],[14,25,9,23],[15,4,10,2],[15,8,10,6,"url"],[15,11,10,24],[16,4,11,2],[16,8,11,6],[16,15,11,13,"urlArg"],[16,21,11,19],[16,26,11,24],[16,34,11,32],[16,36,11,34],[17,6,12,4,"url"],[17,9,12,7],[17,12,12,10,"urlArg"],[17,18,12,16],[18,4,13,2],[18,5,13,3],[18,11,13,9],[18,15,13,13],[18,22,13,20,"urlArg"],[18,28,13,26],[18,33,13,31],[18,41,13,39],[18,45,13,43,"urlArg"],[18,51,13,49],[18,56,13,54],[18,60,13,58],[18,62,13,60],[19,6,14,4,"url"],[19,9,14,7],[19,12,14,10,"urlArg"],[19,18,14,16],[19,19,14,17,"url"],[19,22,14,20],[20,4,15,2],[20,5,15,3],[20,11,15,9],[21,6,16,4,"url"],[21,9,16,7],[21,12,16,10],[21,16,16,14],[22,4,17,2],[23,4,18,2],[23,11,18,9,"url"],[23,14,18,12],[24,2,19,0],[24,3,19,1],[25,2,21,0],[25,8,21,6,"isFirstPartyURL"],[25,23,21,21],[25,26,21,25,"url"],[25,29,21,36],[25,33,21,41],[26,4,22,2],[26,11,23,4,"url"],[26,14,23,7],[26,15,23,8,"startsWith"],[26,25,23,18],[26,26,23,19],[26,29,23,22],[26,30,23,23],[26,34,24,5,"_env2"],[26,39,24,5],[26,40,24,5,"env"],[26,43,24,5],[26,44,24,5,"EXPO_PUBLIC_BASE_URL"],[26,64,24,5],[26,68,24,41,"url"],[26,71,24,44],[26,72,24,45,"startsWith"],[26,82,24,55],[26,83,24,55,"_env2"],[26,88,24,55],[26,89,24,55,"env"],[26,92,24,55],[26,93,24,55,"EXPO_PUBLIC_BASE_URL"],[26,113,24,88],[26,114,24,90],[27,2,26,0],[27,3,26,1],[28,2,28,0],[28,8,28,6,"isSecondPartyURL"],[28,24,28,22],[28,27,28,26,"url"],[28,30,28,37],[28,34,28,42],[29,4,29,2],[29,11,29,9,"url"],[29,14,29,12],[29,15,29,13,"startsWith"],[29,25,29,23],[29,26,29,24],[29,37,29,35],[29,38,29,36],[30,2,30,0],[30,3,30,1],[31,2,33,0],[31,8,33,6,"fetchToWeb"],[31,18,33,16],[31,21,33,19],[31,36,33,34,"fetchWithHeaders"],[31,52,33,50,"fetchWithHeaders"],[31,53,33,51],[31,56,33,54,"args"],[31,60,33,66],[31,62,33,68],[32,4,34,2],[32,10,34,8,"firstPartyURL"],[32,23,34,21],[32,26,34,21,"_env2"],[32,31,34,21],[32,32,34,21,"env"],[32,35,34,21],[32,36,34,21,"EXPO_PUBLIC_BASE_URL"],[32,56,34,56],[33,4,35,2],[33,10,35,8,"secondPartyURL"],[33,24,35,22],[33,27,35,22,"_env2"],[33,32,35,22],[33,33,35,22,"env"],[33,36,35,22],[33,37,35,22,"EXPO_PUBLIC_PROXY_BASE_URL"],[33,63,35,63],[34,4,36,2],[34,8,36,6],[34,9,36,7,"firstPartyURL"],[34,22,36,20],[34,26,36,24],[34,27,36,25,"secondPartyURL"],[34,41,36,39],[34,43,36,41],[35,6,37,4],[35,13,37,11,"expoFetch"],[35,22,37,20],[35,23,37,21],[35,26,37,24,"args"],[35,30,37,28],[35,31,37,29],[36,4,38,2],[37,4,39,2],[37,10,39,8],[37,11,39,9,"input"],[37,16,39,14],[37,18,39,16,"init"],[37,22,39,20],[37,23,39,21],[37,26,39,24,"args"],[37,30,39,28],[38,4,40,2],[38,10,40,8,"url"],[38,13,40,11],[38,16,40,14,"getURLFromArgs"],[38,30,40,28],[38,31,40,29,"input"],[38,36,40,34],[38,38,40,36,"init"],[38,42,40,40],[38,43,40,41],[39,4,41,2],[39,8,41,6],[39,9,41,7,"url"],[39,12,41,10],[39,14,41,12],[40,6,42,4],[40,13,42,11,"expoFetch"],[40,22,42,20],[40,23,42,21,"input"],[40,28,42,26],[40,30,42,28,"init"],[40,34,42,32],[40,35,42,33],[41,4,43,2],[42,4,45,2],[42,10,45,8,"isExternalFetch"],[42,25,45,23],[42,28,45,26],[42,29,45,27,"isFirstPartyURL"],[42,44,45,42],[42,45,45,43,"url"],[42,48,45,46],[42,49,45,47],[43,4,46,2],[44,4,47,2],[44,8,47,6,"isExternalFetch"],[44,23,47,21],[44,25,47,23],[45,6,48,4],[45,13,48,11,"expoFetch"],[45,22,48,20],[45,23,48,21,"input"],[45,28,48,26],[45,30,48,28,"init"],[45,34,48,32],[45,35,48,33],[46,4,49,2],[47,4,51,2],[47,8,51,6,"finalInput"],[47,18,51,16],[47,21,51,19,"input"],[47,26,51,24],[48,4,52,2],[48,10,52,8,"baseURL"],[48,17,52,15],[48,20,52,18,"isSecondPartyURL"],[48,36,52,34],[48,37,52,35,"url"],[48,40,52,38],[48,41,52,39],[48,44,52,42,"secondPartyURL"],[48,58,52,56],[48,61,52,59,"firstPartyURL"],[48,74,52,72],[49,4,53,2],[49,8,53,6],[49,15,53,13,"input"],[49,20,53,18],[49,25,53,23],[49,33,53,31],[49,35,53,33],[50,6,54,4,"finalInput"],[50,16,54,14],[50,19,54,17,"input"],[50,24,54,22],[50,25,54,23,"startsWith"],[50,35,54,33],[50,36,54,34],[50,39,54,37],[50,40,54,38],[50,43,54,41],[50,46,54,44,"baseURL"],[50,53,54,51],[50,56,54,54,"input"],[50,61,54,59],[50,63,54,61],[50,66,54,64,"input"],[50,71,54,69],[51,4,55,2],[51,5,55,3],[51,11,55,9],[52,6,56,4],[52,13,56,11,"originalFetch"],[52,26,56,24],[52,27,56,25,"input"],[52,32,56,30],[52,34,56,32,"init"],[52,38,56,36],[52,39,56,37],[53,4,57,2],[54,4,59,2],[54,10,59,8,"initHeaders"],[54,21,59,19],[54,24,59,22,"init"],[54,28,59,26],[54,30,59,28,"headers"],[54,37,59,35],[54,41,59,39],[54,42,59,40],[54,43,59,41],[55,4,60,2],[55,10,60,8,"finalHeaders"],[55,22,60,20],[55,25,60,23],[55,29,60,27,"Headers"],[55,36,60,34],[55,37,60,35,"initHeaders"],[55,48,60,46],[55,49,60,47],[56,4,62,2],[56,10,62,8,"headers"],[56,17,62,15],[56,20,62,18],[57,6,63,4],[57,36,63,34],[57,38,63,34,"_env2"],[57,43,63,34],[57,44,63,34,"env"],[57,47,63,34],[57,48,63,34,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[57,76,63,76],[58,6,64,4,"host"],[58,10,64,8],[58,12,64,8,"_env2"],[58,17,64,8],[58,18,64,8,"env"],[58,21,64,8],[58,22,64,8,"EXPO_PUBLIC_HOST"],[58,38,64,38],[59,6,65,4],[59,24,65,22],[59,26,65,22,"_env2"],[59,31,65,22],[59,32,65,22,"env"],[59,35,65,22],[59,36,65,22,"EXPO_PUBLIC_HOST"],[59,52,65,52],[60,6,66,4],[60,24,66,22],[60,26,66,22,"_env2"],[60,31,66,22],[60,32,66,22,"env"],[60,35,66,22],[60,36,66,22,"EXPO_PUBLIC_HOST"],[61,4,67,2],[61,5,67,3],[62,4,69,2],[62,9,69,7],[62,15,69,13],[62,16,69,14,"key"],[62,19,69,17],[62,21,69,19,"value"],[62,26,69,24],[62,27,69,25],[62,31,69,29,"Object"],[62,37,69,35],[62,38,69,36,"entries"],[62,45,69,43],[62,46,69,44,"headers"],[62,53,69,51],[62,54,69,52],[62,56,69,54],[63,6,70,4],[63,10,70,8,"value"],[63,15,70,13],[63,17,70,15],[64,8,71,6,"finalHeaders"],[64,20,71,18],[64,21,71,19,"set"],[64,24,71,22],[64,25,71,23,"key"],[64,28,71,26],[64,30,71,28,"value"],[64,35,71,33],[64,36,71,34],[65,6,72,4],[66,4,73,2],[67,4,75,2],[67,10,75,8,"auth"],[67,14,75,12],[67,17,75,15],[67,23,75,21,"SecureStore"],[67,34,75,32],[67,35,75,33,"getItemAsync"],[67,47,75,45],[67,48,75,46,"authKey"],[67,55,75,53],[67,56,75,54],[67,57,76,5,"then"],[67,61,76,9],[67,62,76,11,"auth"],[67,66,76,15],[67,70,76,20],[68,6,77,6],[68,13,77,13,"auth"],[68,17,77,17],[68,20,77,20,"JSON"],[68,24,77,24],[68,25,77,25,"parse"],[68,30,77,30],[68,31,77,31,"auth"],[68,35,77,35],[68,36,77,36],[68,39,77,39],[68,43,77,43],[69,4,78,4],[69,5,78,5],[69,6,78,6],[69,7,79,5,"catch"],[69,12,79,10],[69,13,79,11],[69,19,79,17],[70,6,80,6],[70,13,80,13],[70,17,80,17],[71,4,81,4],[71,5,81,5],[71,6,81,6],[72,4,83,2],[72,8,83,6,"auth"],[72,12,83,10],[72,14,83,12],[73,6,84,4,"finalHeaders"],[73,18,84,16],[73,19,84,17,"set"],[73,22,84,20],[73,23,84,21],[73,38,84,36],[73,40,84,38],[73,50,84,48,"auth"],[73,54,84,52],[73,55,84,53,"jwt"],[73,58,84,56],[73,60,84,58],[73,61,84,59],[74,4,85,2],[75,4,87,2],[75,11,87,9,"expoFetch"],[75,20,87,18],[75,21,87,19,"finalInput"],[75,31,87,29],[75,33,87,31],[76,6,88,4],[76,9,88,7,"init"],[76,13,88,11],[77,6,89,4,"headers"],[77,13,89,11],[77,15,89,13,"finalHeaders"],[78,4,90,2],[78,5,90,3],[78,6,90,4],[79,2,91,0],[79,3,91,1],[80,2,91,2],[80,6,91,2,"_default"],[80,14,91,2],[80,17,91,2,"exports"],[80,24,91,2],[80,25,91,2,"default"],[80,32,91,2],[80,35,93,15,"fetchToWeb"],[80,45,93,25],[81,0,93,25],[81,3]],"functionMap":{"names":["<global>","getURLFromArgs","isFirstPartyURL","isSecondPartyURL","fetchWithHeaders","SecureStore.getItemAsync.then$argument_0","SecureStore.getItemAsync.then._catch$argument_0"],"mappings":"AAA;uBCO;CDW;wBEE;CFK;yBGE;CHE;mBIG;UC2C;KDE;WEC;KFE;CJU"}},"type":"js/module"}]}